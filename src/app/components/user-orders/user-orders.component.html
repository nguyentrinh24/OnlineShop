<div class="user-orders-container">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-md-3">
        <div class="profile-sidebar">
          <div class="user-info">
            <div class="user-avatar">
              <span class="avatar-icon">üë§</span>
            </div>
            <h5>{{ userResponse?.fullname || 'User' }}</h5>
            <p class="text-muted">Th√†nh vi√™n</p>
          </div>
          
          <div class="profile-menu">
            <a class="menu-item active">
              <span class="menu-icon">üõí</span>
              ƒê∆°n mua
            </a>
            <a class="menu-item" (click)="handleItemClick(2)">
              <span class="menu-icon">üë§</span>
              Th√¥ng tin c√° nh√¢n
            </a>
            <a class="menu-item" (click)="handleItemClick(3)">
              <span class="menu-icon">üö™</span>
              ƒêƒÉng xu·∫•t
            </a>
          </div>
        </div>
      </div>
      
      <!-- Main Content -->
      <div class="col-md-9">
        <div class="header-section">
          <h2>ƒê∆°n h√†ng c·ªßa t√¥i</h2>
          <div class="search-section">
            <input 
              type="text" 
              [(ngModel)]="keyword" 
              placeholder="T√¨m ki·∫øm ƒë∆°n h√†ng..."
              class="search-input"
              (keyup.enter)="searchOrders()"
            >
            <button class="btn btn-primary" (click)="searchOrders()">
              <i class="fas fa-search"></i> T√¨m ki·∫øm
            </button>
          </div>
        </div>

        <!-- Filter buttons -->
        <div class="filter-section">
          <div class="btn-group" role="group">
            <button 
              type="button" 
              class="btn" 
              [class.btn-primary]="selectedStatus === 'all'"
              [class.btn-outline-primary]="selectedStatus !== 'all'"
              (click)="filterByStatus('all')"
            >
              T·∫•t c·∫£
            </button>
            <button 
              type="button" 
              class="btn" 
              [class.btn-primary]="selectedStatus === 'pending'"
              [class.btn-outline-primary]="selectedStatus !== 'pending'"
              (click)="filterByStatus('pending')"
            >
              Ch·ªù x·ª≠ l√Ω
            </button>
            <button 
              type="button" 
              class="btn" 
              [class.btn-primary]="selectedStatus === 'processing'"
              [class.btn-outline-primary]="selectedStatus !== 'processing'"
              (click)="filterByStatus('processing')"
            >
              ƒêang x·ª≠ l√Ω
            </button>
            <button 
              type="button" 
              class="btn" 
              [class.btn-primary]="selectedStatus === 'shipped'"
              [class.btn-outline-primary]="selectedStatus !== 'shipped'"
              (click)="filterByStatus('shipped')"
            >
              ƒêang giao
            </button>
            <button 
              type="button" 
              class="btn" 
              [class.btn-primary]="selectedStatus === 'delivered'"
              [class.btn-outline-primary]="selectedStatus !== 'delivered'"
              (click)="filterByStatus('delivered')"
            >
              ƒê√£ giao
            </button>
            <button 
              type="button" 
              class="btn" 
              [class.btn-primary]="selectedStatus === 'cancelled'"
              [class.btn-outline-primary]="selectedStatus !== 'cancelled'"
              (click)="filterByStatus('cancelled')"
            >
              ƒê√£ h·ªßy
            </button>
          </div>
        </div>

        <!-- Orders list -->
        <div class="orders-list">
          <div class="order-card" *ngFor="let order of getFilteredOrders()">
            <div class="order-header">
              <div class="order-info">
                <h5>ƒê∆°n h√†ng #{{ order.id }}</h5>
                <p class="order-date">{{ order.order_date | date:'dd/MM/yyyy HH:mm' }}</p>
              </div>
              <div class="order-status">
                <span class="badge" [ngClass]="getStatusClass(order.status)">
                  {{ getStatusText(order.status) }}
                </span>
              </div>
            </div>

            <div class="order-details">
              <div class="customer-info">
                <p><strong>Ng∆∞·ªùi nh·∫≠n:</strong> {{ order.fullname }}</p>
                <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> {{ order.phone_number }}</p>
                <p><strong>ƒê·ªãa ch·ªâ:</strong> {{ order.address }}</p>
              </div>

              <div class="order-summary">
                <div class="order-items">
                  <div class="order-item" *ngFor="let item of order.order_details">
                    <div class="item-info">
                      <img [src]="item.product.thumbnail" alt="Product" class="item-image">
                      <div class="item-details">
                        <h6>{{ item.product.name }}</h6>
                        <p>S·ªë l∆∞·ª£ng: {{ item.number_of_products }}</p>
                        <p>Gi√°: {{ item.product.price | number:'1.0-0' }} ƒë</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="order-total">
                  <h6>T·ªïng ti·ªÅn: {{ order.total_money | number:'1.0-0' }} ƒë</h6>
                  <p>Ph∆∞∆°ng th·ª©c thanh to√°n: {{ order.payment_method === 'cod' ? 'Thanh to√°n khi nh·∫≠n h√†ng' : order.payment_method }}</p>
                  <p>Ph∆∞∆°ng th·ª©c v·∫≠n chuy·ªÉn: {{ order.shipping_method === 'express' ? 'Nhanh' : 'Th∆∞·ªùng' }}</p>
                </div>
              </div>

              <div class="order-actions">
                <button 
                  class="btn btn-outline-primary btn-sm" 
                  (click)="viewOrderDetails(order)"
                >
                  Xem chi ti·∫øt
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- No orders message -->
        <div class="no-orders" *ngIf="getFilteredOrders().length === 0">
          <div class="text-center">
            <i class="fas fa-shopping-bag fa-3x text-muted mb-3"></i>
            <h5>Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o</h5>
            <p class="text-muted">B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o trong tr·∫°ng th√°i n√†y.</p>
            <a href="/" class="btn btn-primary">Mua s·∫Øm ngay</a>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination-container" *ngIf="totalPages > 1">
          <nav aria-label="Orders pagination">
            <ul class="pagination justify-content-center">
              <li class="page-item" [class.disabled]="currentPage === 0">
                <a class="page-link" (click)="onPageChange(currentPage - 1)" style="cursor: pointer;">
                  Tr∆∞·ªõc
                </a>
              </li>
              
              <li class="page-item" *ngFor="let page of visiblePages" [class.active]="page === currentPage + 1">
                <a class="page-link" (click)="onPageChange(page - 1)" style="cursor: pointer;">
                  {{ page }}
                </a>
              </li>
              
              <li class="page-item" [class.disabled]="currentPage === totalPages - 1">
                <a class="page-link" (click)="onPageChange(currentPage + 1)" style="cursor: pointer;">
                  Sau
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div> 